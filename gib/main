set prefix  /usr/local
set cc      /usr/bin/cc
set cflags  -g -O2
set ldflags
set all
set install

sub? gib/local
sub  gib/bundle/boot.gib

out make directories
dep gib/bundle/manifest.txt
cmd /bin/mkdir -p gib/bundle bin

for src $(gibsrc:*.c)
out $(src:*.c:$1).o
dep make directories
cmd gib.wrapcc $(cc) -c $(cflags) -o $(out) $(srcdir)/$(src)

out bin/gib
add all $(out)
let obj gib/bundle/main.o gib/bundle/sha1.o
dep $(obj)
dep $(gibdir)
cmd $(cc) $(cflags) -o $(out) $(obj)

out $(prefix)/bin/gib
dep bin/gib
cmd /usr/bin/install -D bin/gib $(out)
add install $(out)

for f gib.findsrc gib.wrapcc gib.nochange
out $(prefix)/bin/$(f)
dep $(f)
cmd /usr/bin/install -D $(f) $(out)
add install $(out)
